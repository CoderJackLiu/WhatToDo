# 更新日志

## [2.3.0] - 2024-12-20

### 🚀 新增功能 - 编号显示与窗口状态记忆

#### ✨ 新增功能
- **待办项编号显示** - 每个分组可独立开启/关闭待办项编号显示，编号显示在文本前面（如：`1. 待办事项`）
- **编号显示切换按钮** - 在底部状态栏添加编号显示切换按钮，支持快速开启/关闭
- **窗口状态完整记忆** - 自动记住每个分组窗口的位置、大小和置顶状态
- **重启自动恢复** - 重启软件或开机重启时，自动恢复所有之前打开的分组窗口及其位置和大小
- **关闭窗口记忆** - 关闭分组窗口时自动保存状态，下次打开时恢复

#### 🌐 多语言支持
- **编号功能多语言** - 编号按钮和提示支持中英文切换
- **语言切换同步** - 在设置面板修改语言后，所有打开的分组窗口自动更新语言

#### 🔧 技术改进
- 新增 `show_numbers` 字段支持（数据库字段，兼容本地存储后备方案）
- 优化窗口状态保存逻辑，支持保存已关闭窗口的状态
- 实现窗口关闭、移动、调整大小时的实时状态保存
- 优化语言变化通知机制，确保所有窗口同步更新
- 修复 `data-service.js` 中的错误处理问题

#### 📦 文件变更
- 新增：`docs/DATABASE_MIGRATION_show_numbers.md` - 数据库迁移文档
- 修改：`group-detail.html` - 添加编号显示切换按钮
- 修改：`group-detail.js` - 实现编号显示功能和语言变化监听
- 修改：`groups.js` - 添加语言变化通知机制
- 修改：`main.js` - 实现窗口状态完整保存和恢复机制，添加语言变化通知
- 修改：`preload.js` - 添加语言变化通知 API
- 修改：`data-service.js` - 修复错误处理，优化字段不存在时的处理
- 修改：`i18n.js` - 添加编号相关翻译
- 修改：`styles.css` - 添加编号按钮样式

---

## [2.1.3] - 2024-12-19

### 🚀 功能优化 - 自动记录窗口状态

#### ✨ 功能改进
- **自动记录窗口状态** - 自动记录当前打开的分组窗口，无需手动设置
- **窗口位置记忆** - 自动记住每个分组窗口的位置和大小，重新打开时恢复
- **智能主窗口显示** - 有分组窗口时自动隐藏主窗口，只显示分组窗口
- **实时位置保存** - 窗口移动或调整大小时自动保存位置和大小

#### 🔧 技术改进
- 优化窗口状态保存逻辑，自动记录所有打开的窗口
- 实现窗口位置和大小记忆功能
- 添加窗口移动和调整大小的实时监听
- 优化开机启动逻辑，根据是否有分组窗口决定是否显示主窗口
- 移除手动选择开机启动分组的UI，改为自动记录

#### 📦 文件变更
- 修改：`main.js` - 实现自动记录窗口状态和位置记忆功能
- 修改：`groups.js` - 移除手动选择开机启动分组的UI
- 修改：`groups.html` - 移除开机启动分组选择界面
- 修改：`preload.js` - 移除 `setAutoStartGroups` API
- 修改：`styles.css` - 移除开机启动分组选择相关样式

---

## [2.1.2] - 2024-12-19

### 🚀 新增功能 - 开机启动分组

#### ✨ 新增功能
- **开机启动分组** - 设置开机启动后，自动打开指定的分组窗口（支持1-2个分组）
- **置顶状态记忆** - 自动记住每个分组窗口的置顶状态，开机后恢复
- **分组选择界面** - 在设置菜单中添加开机启动分组选择功能
- **智能启动逻辑** - 等待认证完成后再打开分组，确保数据正常加载

#### 🎨 UI 优化
- **设置界面增强** - 添加开机启动分组选择列表，支持多选和置顶设置
- **分组选择样式** - 优化分组选择列表的视觉效果和交互体验

#### 🔧 技术改进
- 新增 `autoStartGroups` 设置字段，保存开机启动分组配置
- 优化窗口创建逻辑，支持指定初始置顶状态
- 实现窗口关闭时自动保存置顶状态
- 优化启动流程，确保认证完成后再打开分组窗口

#### 📦 文件变更
- 修改：`main.js` - 添加开机启动分组加载逻辑和置顶状态保存
- 修改：`groups.js` - 添加开机启动分组选择UI和保存逻辑
- 修改：`groups.html` - 添加开机启动分组选择界面
- 修改：`preload.js` - 添加 `setAutoStartGroups` API
- 修改：`styles.css` - 添加开机启动分组选择样式

---

## [2.1.1] - 2024-12-19

### 🚀 重大功能更新

#### ✨ 新增功能
- **GitHub OAuth 登录** - 集成 GitHub OAuth 登录功能，支持使用 GitHub 账号快速登录
- **邮箱确认流程增强** - 优化邮箱确认流程，提升用户体验和反馈
- **自定义对话框系统** - 实现自定义对话框组件，替换原生 alert 和 confirm，提供更好的视觉体验
- **主窗口显示功能** - 在分组详情窗口添加按钮，可快速显示主窗口
- **分组主题同步增强** - 优化分组主题颜色同步机制，确保多窗口间主题一致性

#### 🎨 UI 优化
- **设置界面优化** - 去除所有功能描述文字，界面更简洁
- **排版美化** - 调整设置项字体大小和间距，左右元素更协调
- **视觉统一** - 统一设置项文字大小，提升整体视觉效果
- **设置按钮优化** - 使用图片资源替换 SVG，提升视觉效果
- **对话框样式优化** - 优化自定义对话框的样式，提升美观度和响应式设计

#### 🔧 技术改进
- 优化设置项布局，调整内边距和间距
- 调整按钮和开关尺寸，与文字大小更匹配
- 优化用户信息项字体大小，保持一致性
- 实现分组主题的实时同步更新机制
- 优化对话框组件的响应式设计

#### 📦 项目结构
- 重构项目结构，将所有文档移动到 `docs/` 目录
- 优化文件组织，提升项目可维护性

#### 📦 文件变更
- 新增：`src/renderer/utils/dialog.js` - 自定义对话框系统
- 新增：`src/renderer/assets/Settings.png` - 设置按钮图片资源
- 修改：`auth-service.js` - 集成 GitHub OAuth 登录
- 修改：`main.js` - 添加主窗口显示功能和 GitHub 登录浏览器打开逻辑
- 修改：`login.js` - 优化登录流程和状态管理
- 修改：`groups.js` - 增强分组主题同步功能
- 修改：`group-detail.js` - 添加主窗口显示按钮和自定义对话框
- 修改：`groups.html` - 移除设置项描述文字，更新设置按钮
- 修改：`index.html` - 移除设置项描述文字，更新设置按钮
- 修改：`login.html` - 优化登录界面 UI
- 修改：`styles.css` - 优化设置界面样式、对话框样式和整体排版
- 修改：`i18n.js` - 添加新功能的翻译支持
- 修改：`README.md` - 添加 GitHub OAuth 配置说明
- 重构：所有文档文件移动到 `docs/` 目录

---

## [2.1.0] - 2024-12-19

### 🔐 新增功能 - 持久登录

#### ✨ 新增功能
- **持久登录状态** - 登录后保持10天登录状态，无需每次启动重新登录
- **加密 Session 存储** - 使用 AES-256-GCM 加密算法安全存储 session 信息
- **Session 过期提示** - Session 过期时显示友好的提示信息，引导用户重新登录
- **自动 Session 恢复** - 应用启动时自动恢复有效的 session，提升用户体验

#### 🔧 技术改进
- 新增 `session-service.js` - Session 加密存储服务
- 优化 `auth-service.js` - 集成 session 保存和恢复逻辑
- 优化 `main.js` - 启动时自动恢复 session
- 优化 `login.js` - 添加 session 过期提示 UI
- 更新 `preload.js` - 添加 session-expired 事件监听

#### 📦 文件变更
- 新增：`session-service.js` - Session 加密存储服务
- 修改：`auth-service.js` - 添加 session 保存和恢复功能
- 修改：`main.js` - 启动时恢复 session
- 修改：`login.html` - 添加 session 过期提示 UI
- 修改：`login.js` - 添加过期提示显示逻辑
- 修改：`preload.js` - 添加 session-expired 事件 API
- 修改：`styles.css` - 添加 session 过期提示样式
- 修改：`package.json` - 版本号更新为 2.1.0

---

## [2.0.0] - 2024-11-19

### 🚀 重大更新 - 性能优化

这是一个重大性能优化版本，引入了智能缓存机制，大幅提升应用响应速度。

#### ✨ 新增功能
- **本地缓存系统** - 新增完整的本地缓存服务，使用 JSON 文件缓存所有数据
- **乐观更新机制** - 用户操作立即生效，后台异步同步服务器
- **智能加载策略** - 优先从缓存加载，后台异步同步服务器数据
- **防抖优化** - 为拖拽排序等操作添加防抖，避免频繁请求

#### ⚡ 性能提升
- **启动加载速度**：从 2-3 秒降至 < 100ms（提升 95%+）
- **添加待办响应**：从 500-1000ms 降至 < 50ms（提升 95%+）
- **切换分组响应**：从 300-800ms 降至 < 50ms（提升 90%+）
- **网络请求减少**：减少约 90%

#### 🔧 技术改进
- 新增 `cache-service.js` - 缓存服务模块
- 优化 `data-service.js` - 集成缓存层和乐观更新
- 优化 `group-detail.js` - 使用缓存数据，减少重复加载
- 优化 `groups.js` - 增量更新策略，防抖优化
- 更新文档 - 添加性能优化说明和技术文档

#### ✅ 保持功能
- 多设备实时同步功能完整保留
- Supabase Realtime 订阅正常工作
- 服务器数据优先，确保数据一致性
- 离线时仍可查看已缓存的数据

#### 📦 文件变更
- 新增：`cache-service.js` - 缓存服务
- 新增：`PERFORMANCE_OPTIMIZATION.md` - 性能优化技术文档
- 新增：`CHANGELOG.md` - 更新日志
- 修改：`data-service.js` - 集成缓存和乐观更新
- 修改：`group-detail.js` - 优化加载和防抖
- 修改：`groups.js` - 优化加载和防抖
- 修改：`README.md` - 添加性能优化说明
- 修改：`package.json` - 版本号更新为 2.0.0

---

## [1.0.3] - 2024-11-18

### 功能更新
- 基础分组管理功能
- 多窗口支持
- Supabase 云端同步
- 实时数据同步
- 系统托盘支持

---

## 版本命名规则

遵循语义化版本规范（Semantic Versioning）：
- **主版本号（Major）**：不兼容的 API 修改或重大功能更新
- **次版本号（Minor）**：向下兼容的功能性新增
- **修订号（Patch）**：向下兼容的问题修正

